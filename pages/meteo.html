<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Météo</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    //css
    <script
</head>
<body>
    <div class="container">
        <div class="weather-container">
            <div class="search-container">
                <input 
                    id="cityInput" 
                    type="text" 
                    placeholder="Entrez votre ville" 
                    value="Limoges"
                />
                <button 
                    id="searchBtn" 
                    title="Rechercher"
                >
                    <svg 
                        clip-rule="evenodd" 
                        fill-rule="evenodd" 
                        stroke-linejoin="round" 
                        stroke-miterlimit="2" 
                        viewBox="0 0 24 24" 
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path 
                            d="m15.97 17.031c-1.479 1.238-3.384 1.985-5.461 1.985-4.697 0-8.509-3.812-8.509-8.508s3.812-8.508 8.509-8.508c4.695 0 8.508 3.812 8.508 8.508 0 2.078-.747 3.984-1.985 5.461l4.749 4.75c.146.146.219.338.219.531 0 .587-.537.75-.75.75-.192 0-.384-.073-.531-.22zm-5.461-13.53c-3.868 0-7.007 3.14-7.007 7.007s3.139 7.007 7.007 7.007c3.866 0 7.007-3.14 7.007-7.007s-3.141-7.007-7.007-7.007z"
                            fill-rule="nonzero"
                        />
                    </svg>
                </button>
            </div>

            <img id="cloudImage" src="../assets/img/cloud.png" alt="Cloud"/>
            
            <h1 id="cityName">Limoges</h1>

            <div class="weather-info">
                <p id="temperature">--°C</p>
                <img id="weatherIcon" src="" alt="Icone météo"/>
            </div>
        </div>

        <div class="footer">
            <span>
                © 2023 Météo, 
                <a href="https://hugorytlewski.com" target="_blank" rel="noopener">Hugo Rytlewski</a>
                Tous droits réservés
            </span>
            <div class="footer-links">
                <a href="https://www.linkedin.com/in/hugo-rytlewski-b06841281/" rel="noopener" target="_blank">
                    <img src="https://via.placeholder.com/24" alt="LinkedIn"/>
                </a>
                <a href="https://github.com/HugoRytlewski" target="_blank" rel="noopener">
                    <img src="https://via.placeholder.com/24" alt="GitHub"/>
                </a>
            </div>
        </div>

        <div id="errorModal">
            <div class="error-modal-content">
                <img src="https://via.placeholder.com/160" alt="Error" class="error-modal-image"/>
                <p class="error-modal-text">
                    La ville saisie n'a pas été trouvée ou est incorrecte
                </p>
                <button id="closeModalBtn">
                    D'accord !
                </button>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = '1c014d7470bc87a0ac57d62cc0cf852b';

        // Elements
        const cityInput = document.getElementById('cityInput');
        const searchBtn = document.getElementById('searchBtn');
        const cityName = document.getElementById('cityName');
        const temperature = document.getElementById('temperature');
        const weatherIcon = document.getElementById('weatherIcon');
        const errorModal = document.getElementById('errorModal');
        const closeModalBtn = document.getElementById('closeModalBtn');

        // Fetch weather data
        async function getMeteo(city) {
            try {
                const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&lang=fr&appid=${API_KEY}`;
                const response = await axios.get(apiUrl);
                const data = response.data;

                // Update UI
                cityName.textContent = data.name;
                temperature.textContent = `${parseInt(data.main.temp)}°C`;
                weatherIcon.src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
                
                console.log(data);
            } catch (error) {
                showErrorModal();
                console.error('Erreur météo', error);
            }
        }

        // Show error modal
        function showErrorModal() {
            errorModal.style.display = 'flex';
        }

        // Close error modal
        function closeModal() {
            errorModal.style.display = 'none';
            cityInput.value = '';
        }

        // Event Listeners
        searchBtn.addEventListener('click', () => getMeteo(cityInput.value));
        cityInput.addEventListener('keyup', (event) => {
            if (event.key === 'Enter') {
                getMeteo(cityInput.value);
            }
        });
        closeModalBtn.addEventListener('click', closeModal);

        // Initial load
        getMeteo('Limoges');
    </script>
</body>
</html>